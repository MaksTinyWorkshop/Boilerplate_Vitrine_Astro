---
import { listDefaultLocaleSlugs, resolveDefaultLocaleRedirect } from "@lib/i18n/pages";

export async function getStaticPaths() {
  const pages = await listDefaultLocaleSlugs();

  return pages
    .filter(({ slug }) => Boolean(slug))
    .map(({ slug }) => ({
      params: { slug },
    }));
}

const redirectTargetPromise = resolveDefaultLocaleRedirect(Astro.params.slug ?? "");
void redirectTargetPromise;

return Astro.redirect(await redirectTargetPromise, 307);
---
